#用于重写变量代码
library(car)
#用于重新整理数据
library(reshape)
#用于汇总及传输
library(plyr)
library(rmarkdown)
library(htmltools)
# Load the Data
wine = read.csv('wineQualityWhites.csv')
describe(wine)
names(wine)
wine = wine[,2:13]
names(wine)
summary(wine)
ggplot(aes(x = quality), data = wine) +
geom_histogram(binwidth = 1)
ggplot(aes(x = quality), data = wine) +
geom_histogram(binwidth = 0.1)
summary(wine$quality)
ggplot(aes(x = pH), data = wine) +
geom_histogram(binwidth = 0.01)
summary(wine$pH)
ggplot(aes(x = residual.sugar), data = wine) +
geom_histogram(binwidth = 1)
ggplot(aes(x = residual.sugar), data = wine) +
geom_histogram(binwidth = 0.1)
ggplot(aes(x = residual.sugar), data = wine) +
geom_histogram(binwidth = 0.03) +
scale_x_log10()
summary(wine$residual.sugar)
ggplot(aes(x = fixed.acidity), data = wine) +
geom_histogram(binwidth = 0.05)
summary(wine$fixed.acidity)
ggplot(aes(x = volatile.acidity), data = wine) +
geom_histogram(binwidth = 0.01) +
scale_x_log10()
summary(wine$volatile.acidity)
ggplot(aes(x = citric.acid), data = wine) +
geom_histogram(binwidth = 0.01)
summary(wine$citric.acid)
wine$acid = wine$fixed.acidity + wine$volatile.acidity + wine$citric.acid
ggplot(aes(x = acid), data = wine) +
geom_histogram(binwidth = 0.01)
acid_nor1 = (wine$fixed.acidity - min(wine$fixed.acidity)) /
(max(wine$fixed.acidity) - min(wine$fixed.acidity))
acid_nor2 = (wine$volatile.acidity - min(wine$volatile.acidity)) /
(max(wine$volatile.acidity) - min(wine$volatile.acidity))
acid_nor3 = (wine$citric.acid - min(wine$citric.acid)) /
(max(wine$citric.acid) - min(wine$citric.acid))
wine$acid_nor = acid_nor1 + acid_nor2 + acid_nor1
ggplot(aes(x = acid_nor), data = wine) +
geom_histogram(binwidth = 0.01)
ggplot(aes(x = chlorides), data = wine) +
geom_histogram(binwidth = 0.001)
ggplot(aes(x = chlorides), data = wine) +
geom_histogram(binwidth = 0.01) +
scale_x_log10()
summary(wine$chlorides)
ggplot(aes(x = free.sulfur.dioxide), data = wine) +
geom_histogram(binwidth = 1)
ggplot(aes(x = free.sulfur.dioxide), data = wine) +
geom_histogram(binwidth = 0.01) +
scale_x_log10()
summary(wine$free.sulfur.dioxide)
ggplot(aes(x = total.sulfur.dioxide), data = wine) +
geom_histogram(binwidth = 1)
summary(wine$total.sulfur.dioxide)
ggplot(aes(x = density), data = wine) +
geom_histogram(binwidth = 0.0001)
summary(wine$density)
ggplot(aes(x = density), data = subset(wine, wine$density < 1.01)) +
geom_histogram(binwidth = 0.0001)
summary(subset(wine, wine$density < 1.01)$density)
ggplot(aes(x = sulphates), data = wine) +
geom_histogram(binwidth = 0.01)
summary(wine$sulphates)
ggplot(aes(x = alcohol), data = wine) +
geom_histogram(binwidth = 0.1)
summary(wine$alcohol)
cor(wine)
pairs.panels(wine, pch = '.')
ggplot(aes(x = alcohol, y = quality), data = wine) +
geom_jitter(alpha = 0.1) +
geom_smooth()
wine$quality = factor(wine$quality)
ggplot(wine,aes(quality, alcohol)) +
geom_jitter(alpha=0.3) +
geom_boxplot( alpha = 0.5,color = 'blue')+
stat_summary(fun.y = "mean",
geom = "point",
color = "red")+
geom_smooth(method='lm', aes(group = 1))+
ggtitle('红酒质量和酒精浓度关系图') +
theme(plot.title = element_text(hjust = 0.5))
m1 = lm(quality ~ alcohol, data = wine)
m1
detach("package:plyr", unload=TRUE)
wineByQuality = wine %>%
group_by(quality) %>%
summarise(mean_density = mean(density),
median_density = median(density),
min_price = min(density),
mxa_price = max(density),
n = n()) %>%
arrange(quality)
head(wineByQuality)
newpalette<-colorRampPalette(brewer.pal(9,"Blues"))(7)
wine$quality = factor(wine$quality)
ggplot(aes(x = quality, y = density),
data = subset(wine, wine$density < quantile(wine$density, 0.99))) +
geom_boxplot(col = newpalette)
ggplot(aes(x = alcohol, y = density),
data = subset(wine, wine$density < quantile(wine$density, 0.99))) +
geom_point(alpha = 0.2) +
geom_smooth()
ggplot(aes(x = residual.sugar, y = density),
data = subset(wine, wine$density < quantile(wine$density, 0.99))) +
geom_point(alpha = 0.1)
m2 = lm(density ~ residual.sugar, data = wine)
m2
ggplot(aes(x = free.sulfur.dioxide, y = total.sulfur.dioxide), data = wine) +
geom_point(alpha = 0.1)
ggplot(aes(x = free.sulfur.dioxide, y = total.sulfur.dioxide), data = wine) +
geom_point(alpha = 0.1) +
xlim(0, 100)
ggplot(aes(x = free.sulfur.dioxide / total.sulfur.dioxide), data = wine) +
geom_histogram(binwidth = 0.01)
newpalette<-colorRampPalette(brewer.pal(9,"Blues"))(7)
wine$quality = factor(wine$quality)
ggplot(aes(x = quality, y = free.sulfur.dioxide / total.sulfur.dioxide),
data = wine) +
geom_boxplot(col=brewer.pal(7,"Set3"))
wine$quality = as.numeric(wine$quality)
wine$sulfur = wine$free.sulfur.dioxide/wine$total.sulfur.dioxide
cor.test(wine$quality, wine$sulfur)
cor(wine)
wine$quality = factor(wine$quality)
ggplot(aes(x = density, y = alcohol), data = subset(wine, wine$density < quantile(wine$density, 0.9))) +
geom_point(aes(color = quality), size = 3) +
scale_color_brewer(type = 'qua',
guide = guide_legend(title = 'quality', reverse = TRUE,
override.aes = list(alpha = 1, size = 2)))
plot1 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 1)) +
ggtitle('quality:3') +
theme(plot.title = element_text(hjust = 0.5))
plot2 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 2)) +
ggtitle('quality:4') +
theme(plot.title = element_text(hjust = 0.5))
plot3 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 3)) +
ggtitle('quality:5') +
theme(plot.title = element_text(hjust = 0.5))
plot4 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 4)) +
ggtitle('quality:6') +
theme(plot.title = element_text(hjust = 0.5))
plot5 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 5)) +
ggtitle('quality:7') +
theme(plot.title = element_text(hjust = 0.5))
plot6 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 6)) +
ggtitle('quality:8') +
theme(plot.title = element_text(hjust = 0.5))
plot7 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 7)) +
ggtitle('quality:9') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, ncol = 3)
ggplot(aes(x= fixed.acidity, y= volatile.acidity), data = wine) +
geom_point(aes(color = quality))+
facet_wrap(~quality)+
ggtitle('红酒质量与挥发酸及非挥发酸之间相关关系图') +
theme(plot.title = element_text(hjust = 0.5))
wine$quality = as.numeric(wine$quality)
m1 = lm(I(quality) ~ I(alcohol), data = subset(wine,
wine$density < quantile(wine$density, 0.9)))
m2 = update(m1, ~ . + density)
m3 = update(m2, ~ . + chlorides)
m4 = update(m3, ~ . + acid_nor)
m5 = update(m4, ~ . + sulfur)
mtable(m1, m2, m3, m4, m5)
wine_norm = data.frame()
wine_norm = scale(wine, center = FALSE, scale = TRUE)
wine_norm = as.data.frame(wine_norm)
cor(wine_norm)
m6 = lm(I(quality) ~ I(alcohol), data = subset(wine_norm, wine_norm$density < quantile(wine_norm$density, 0.9)))
m7 = update(m6, ~ . + density)
m8 = update(m7, ~ . + chlorides)
m9 = update(m8, ~ . + acid_nor)
m10 = update(m9, ~ . + sulfur)
mtable(m6, m7, m8, m9, m10)
ggplot(aes(x = residual.sugar), data = wine) +
geom_histogram(binwidth = 0.03) +
scale_x_log10() +
ggtitle('白葡萄酒中剩余糖分的含量分布图') +
theme(panel.background = element_rect(fill = "lightblue", colour = "red", size = 3),
plot.title = element_text(hjust = 0.5))
ggplot(aes(x = alcohol, y = density),
data = subset(wine, wine$density < quantile(wine$density, 0.99))) +
geom_point(alpha = 0.2, color = 'orange') +
geom_smooth() +
ggtitle('酒精含量与密度的关系') +
theme(panel.background = element_rect(fill = "black"),
plot.title = element_text(hjust = 0.5))
plot1 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 1)) +
ggtitle('quality:3') +
theme(plot.title = element_text(hjust = 0.5))
plot2 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 2)) +
ggtitle('quality:4') +
theme(plot.title = element_text(hjust = 0.5))
plot3 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 3)) +
ggtitle('quality:5') +
theme(plot.title = element_text(hjust = 0.5))
plot4 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 4)) +
ggtitle('quality:6') +
theme(plot.title = element_text(hjust = 0.5))
plot5 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 5)) +
ggtitle('quality:7') +
theme(plot.title = element_text(hjust = 0.5))
plot6 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 6)) +
ggtitle('quality:8') +
theme(plot.title = element_text(hjust = 0.5))
plot7 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 7)) +
ggtitle('quality:9') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, ncol = 3)
wine$quality = factor(wine$quality)
ggplot(aes(x = density, y = alcohol), data = subset(wine, wine$density < quantile(wine$density, 0.9))) +
geom_point(alpha = 0.2) +
scale_color_brewer(palette = 'Blues')
wine$quality = factor(wine$quality)
ggplot(aes(x = density, y = alcohol, color = factor(quality)),
data = subset(wine, wine$density < quantile(wine$density, 0.9))) +
geom_point(alpha = 0.2) +
scale_color_brewer(palette = 'Blues')
wine$quality = factor(wine$quality)
ggplot(aes(x = density, y = alcohol, color = factor(quality)),
data = subset(wine, wine$density < quantile(wine$density, 0.9))) +
geom_point(alpha = 0.2) +
scale_color_brewer(palette = 'Blues') +
geom_smooth(method = 'lm', se = FALSE, size = 1)
wine$quality = factor(wine$quality)
ggplot(aes(x = density, y = alcohol, color = factor(quality)),
data = subset(wine, wine$density < quantile(wine$density, 0.9))) +
geom_jitter(alpha = 0.2) +
scale_color_brewer(palette = 'Blues') +
geom_smooth(method = 'lm', se = FALSE, size = 1)
ggplot(aes(x= fixed.acidity, y= volatile.acidity), data = wine) +
geom_point()+
facet_wrap(~quality)+
ggtitle('红酒质量与挥发酸及非挥发酸之间相关关系图') +
theme(plot.title = element_text(hjust = 0.5))
wine$quality = factor(wine$quality)
ggplot(aes(x = quality, y = free.sulfur.dioxide / total.sulfur.dioxide),
data = wine) +
geom_boxplot()
wine$sugar_acid = wine$acid / wine$residual.sugar
ggplot(aes(x = sugar_acid), data = wine) +
geom_histogram(binwidth = 0.01) +
scale_x_log10()
ggplot(aes(x = sugar_acid), data = wine) +
geom_histogram(binwidth = 0.01)
ggplot(aes(x = sugar_acid), data = wine) +
geom_histogram(binwidth = 0.01) +
scale_x_log10()
cor(wine)
knitr::opts_chunk$set(message = FALSE, warning = FALSE, echo = FALSE)
# Load all of the packages that you end up using
# in your analysis in this code chunk.
# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.
library(ggplot2)
library(psych)
library('RCurl')
library('bitops')
library(dplyr)
library(gridExtra)
library(RColorBrewer)
library(GGally)
# 用于表现一些内容
library(scales)
# 用于汇总递归
#install.packages('memisc')
library(memisc)
#用于其他方面
library(lattice)
#用于各种函数
library(MASS)
#用于重写变量代码
library(car)
#用于重新整理数据
library(reshape)
#用于汇总及传输
library(plyr)
library(rmarkdown)
library(htmltools)
# Load the Data
wine = read.csv('wineQualityWhites.csv')
describe(wine)
names(wine)
wine = wine[,2:13]
names(wine)
summary(wine)
ggplot(aes(x = quality), data = wine) +
geom_histogram(binwidth = 1)
ggplot(aes(x = quality), data = wine) +
geom_histogram(binwidth = 0.1)
summary(wine$quality)
ggplot(aes(x = pH), data = wine) +
geom_histogram(binwidth = 0.01)
summary(wine$pH)
ggplot(aes(x = residual.sugar), data = wine) +
geom_histogram(binwidth = 1)
ggplot(aes(x = residual.sugar), data = wine) +
geom_histogram(binwidth = 0.1)
ggplot(aes(x = residual.sugar), data = wine) +
geom_histogram(binwidth = 0.03) +
scale_x_log10()
summary(wine$residual.sugar)
ggplot(aes(x = fixed.acidity), data = wine) +
geom_histogram(binwidth = 0.05)
summary(wine$fixed.acidity)
ggplot(aes(x = volatile.acidity), data = wine) +
geom_histogram(binwidth = 0.01) +
scale_x_log10()
summary(wine$volatile.acidity)
ggplot(aes(x = citric.acid), data = wine) +
geom_histogram(binwidth = 0.01)
summary(wine$citric.acid)
wine$acid = wine$fixed.acidity + wine$volatile.acidity + wine$citric.acid
ggplot(aes(x = acid), data = wine) +
geom_histogram(binwidth = 0.01)
acid_nor1 = (wine$fixed.acidity - min(wine$fixed.acidity)) /
(max(wine$fixed.acidity) - min(wine$fixed.acidity))
acid_nor2 = (wine$volatile.acidity - min(wine$volatile.acidity)) /
(max(wine$volatile.acidity) - min(wine$volatile.acidity))
acid_nor3 = (wine$citric.acid - min(wine$citric.acid)) /
(max(wine$citric.acid) - min(wine$citric.acid))
wine$acid_nor = acid_nor1 + acid_nor2 + acid_nor1
ggplot(aes(x = acid_nor), data = wine) +
geom_histogram(binwidth = 0.01)
ggplot(aes(x = chlorides), data = wine) +
geom_histogram(binwidth = 0.001)
wine$sugar_acid = wine$acid / wine$residual.sugar
ggplot(aes(x = sugar_acid), data = wine) +
geom_histogram(binwidth = 0.01) +
scale_x_log10()
ggplot(aes(x = chlorides), data = wine) +
geom_histogram(binwidth = 0.01) +
scale_x_log10()
summary(wine$chlorides)
ggplot(aes(x = free.sulfur.dioxide), data = wine) +
geom_histogram(binwidth = 1)
ggplot(aes(x = free.sulfur.dioxide), data = wine) +
geom_histogram(binwidth = 0.01) +
scale_x_log10()
summary(wine$free.sulfur.dioxide)
ggplot(aes(x = total.sulfur.dioxide), data = wine) +
geom_histogram(binwidth = 1)
summary(wine$total.sulfur.dioxide)
ggplot(aes(x = density), data = wine) +
geom_histogram(binwidth = 0.0001)
summary(wine$density)
ggplot(aes(x = density), data = subset(wine, wine$density < 1.01)) +
geom_histogram(binwidth = 0.0001)
summary(subset(wine, wine$density < 1.01)$density)
ggplot(aes(x = sulphates), data = wine) +
geom_histogram(binwidth = 0.01)
summary(wine$sulphates)
ggplot(aes(x = alcohol), data = wine) +
geom_histogram(binwidth = 0.1)
summary(wine$alcohol)
cor(wine)
pairs.panels(wine, pch = '.')
ggplot(aes(x = alcohol, y = quality), data = wine) +
geom_jitter(alpha = 0.1) +
geom_smooth()
wine$quality = factor(wine$quality)
ggplot(wine,aes(quality, alcohol)) +
geom_jitter(alpha=0.3) +
geom_boxplot( alpha = 0.5,color = 'blue')+
stat_summary(fun.y = "mean",
geom = "point",
color = "red")+
geom_smooth(method='lm', aes(group = 1))+
ggtitle('红酒质量和酒精浓度关系图') +
theme(plot.title = element_text(hjust = 0.5))
m1 = lm(quality ~ alcohol, data = wine)
m1
detach("package:plyr", unload=TRUE)
wineByQuality = wine %>%
group_by(quality) %>%
summarise(mean_density = mean(density),
median_density = median(density),
min_price = min(density),
mxa_price = max(density),
n = n()) %>%
arrange(quality)
head(wineByQuality)
newpalette<-colorRampPalette(brewer.pal(9,"Blues"))(7)
wine$quality = factor(wine$quality)
ggplot(aes(x = quality, y = density),
data = subset(wine, wine$density < quantile(wine$density, 0.99))) +
geom_boxplot(col = newpalette)
ggplot(aes(x = alcohol, y = density),
data = subset(wine, wine$density < quantile(wine$density, 0.99))) +
geom_point(alpha = 0.2) +
geom_smooth()
ggplot(aes(x = residual.sugar, y = density),
data = subset(wine, wine$density < quantile(wine$density, 0.99))) +
geom_point(alpha = 0.1)
m2 = lm(density ~ residual.sugar, data = wine)
m2
ggplot(aes(x = free.sulfur.dioxide, y = total.sulfur.dioxide), data = wine) +
geom_point(alpha = 0.1)
ggplot(aes(x = free.sulfur.dioxide, y = total.sulfur.dioxide), data = wine) +
geom_point(alpha = 0.1) +
xlim(0, 100)
ggplot(aes(x = free.sulfur.dioxide / total.sulfur.dioxide), data = wine) +
geom_histogram(binwidth = 0.01)
wine$quality = factor(wine$quality)
ggplot(aes(x = quality, y = free.sulfur.dioxide / total.sulfur.dioxide),
data = wine) +
geom_boxplot()
wine$quality = as.numeric(wine$quality)
wine$sulfur = wine$free.sulfur.dioxide/wine$total.sulfur.dioxide
cor.test(wine$quality, wine$sulfur)
cor(wine)
wine$quality = factor(wine$quality)
ggplot(aes(x = density, y = alcohol, color = factor(quality)),
data = subset(wine, wine$density < quantile(wine$density, 0.9))) +
geom_jitter(alpha = 0.2) +
scale_color_brewer(palette = 'Blues') +
geom_smooth(method = 'lm', se = FALSE, size = 1)
plot1 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 1)) +
ggtitle('quality:3') +
theme(plot.title = element_text(hjust = 0.5))
plot2 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 2)) +
ggtitle('quality:4') +
theme(plot.title = element_text(hjust = 0.5))
plot3 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 3)) +
ggtitle('quality:5') +
theme(plot.title = element_text(hjust = 0.5))
plot4 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 4)) +
ggtitle('quality:6') +
theme(plot.title = element_text(hjust = 0.5))
plot5 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 5)) +
ggtitle('quality:7') +
theme(plot.title = element_text(hjust = 0.5))
plot6 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 6)) +
ggtitle('quality:8') +
theme(plot.title = element_text(hjust = 0.5))
plot7 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 7)) +
ggtitle('quality:9') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, ncol = 3)
ggplot(aes(x= fixed.acidity, y= volatile.acidity), data = wine) +
geom_point()+
facet_wrap(~quality)+
ggtitle('红酒质量与挥发酸及非挥发酸之间相关关系图') +
theme(plot.title = element_text(hjust = 0.5))
wine$quality = as.numeric(wine$quality)
m1 = lm(I(quality) ~ I(alcohol), data = subset(wine,
wine$density < quantile(wine$density, 0.9)))
m2 = update(m1, ~ . + density)
m3 = update(m2, ~ . + chlorides)
m4 = update(m3, ~ . + acid_nor)
m5 = update(m4, ~ . + sulfur)
mtable(m1, m2, m3, m4, m5)
wine_norm = data.frame()
wine_norm = scale(wine, center = FALSE, scale = TRUE)
wine_norm = as.data.frame(wine_norm)
cor(wine_norm)
m6 = lm(I(quality) ~ I(alcohol), data = subset(wine_norm, wine_norm$density < quantile(wine_norm$density, 0.9)))
m7 = update(m6, ~ . + density)
m8 = update(m7, ~ . + chlorides)
m9 = update(m8, ~ . + acid_nor)
m10 = update(m9, ~ . + sulfur)
mtable(m6, m7, m8, m9, m10)
ggplot(aes(x = residual.sugar), data = wine) +
geom_histogram(binwidth = 0.03) +
scale_x_log10() +
ggtitle('白葡萄酒中剩余糖分的含量分布图') +
theme(panel.background = element_rect(fill = "lightblue", colour = "red", size = 3),
plot.title = element_text(hjust = 0.5))
ggplot(aes(x = alcohol, y = density),
data = subset(wine, wine$density < quantile(wine$density, 0.99))) +
geom_point(alpha = 0.2, color = 'orange') +
geom_smooth() +
ggtitle('酒精含量与密度的关系') +
theme(panel.background = element_rect(fill = "black"),
plot.title = element_text(hjust = 0.5))
plot1 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 1)) +
ggtitle('quality:3') +
theme(plot.title = element_text(hjust = 0.5))
plot2 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 2)) +
ggtitle('quality:4') +
theme(plot.title = element_text(hjust = 0.5))
plot3 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 3)) +
ggtitle('quality:5') +
theme(plot.title = element_text(hjust = 0.5))
plot4 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 4)) +
ggtitle('quality:6') +
theme(plot.title = element_text(hjust = 0.5))
plot5 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 5)) +
ggtitle('quality:7') +
theme(plot.title = element_text(hjust = 0.5))
plot6 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 6)) +
ggtitle('quality:8') +
theme(plot.title = element_text(hjust = 0.5))
plot7 <- qplot(x = acid, y = pH, data = subset(wine, wine$quality == 7)) +
ggtitle('quality:9') +
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, plot7, ncol = 3)
